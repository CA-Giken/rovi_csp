# プロトコル仕様

## スクリプト(UR)とリクエストの対応  
URスクリプトとビジョンコントローラへのリクエストの対応は下表となります。
|スクリプト名|パラメータ([]は省略可)|リクエスト名|処理内容|
|:---|:---|:---|:---|
|RESET|-|リセット|撮像したデータをクリアします。|
|CAPTURE|[座標]|キャプチャ|撮像します。撮像データがクリアされていないときは、これに合成されます。|
|SOLVE|[座標]|解析|撮像データを解析します。解析内容はビジョンコントローラのモードにより異なります。|
|RECIPE|レシピ名|レシピ選択|レシピ名に一致するレシピを選びます。|

## 処理結果  
リクエストに応じた処理の実行結果は、正常終了した場合とエラー終了した場合でそれぞれ異なる値が返されます。

### 正常終了値  
処理が正常終了した場合は、文字列 **OK** に続いて以下の終了値が返されます。

<table>
<tr><th>スクリプト名<th>終了値<th>備考</tr>
<tr><td>RESET<td>なし<td></tr>
<tr><td>CAPTURE<td>候補数,柱距離,□,□<td><font size="0.8em">3,4番目は予約</font></tr>
<tr><td>SOLVE<td>座標<td><font size="0.8em">キャリブモード:次の撮影位置<br>バケット探索モード:バケット柱上端</font></tr>
<tr><td>RECIPE<td>なし<td></tr>
</table>

<div style="page-break-before:always"></div>

### エラーコード
処理がエラー終了した場合は、文字列 **NG** に続いて以下のエラーコードが返されます。

<table>
<tr><th>スクリプト名<th>エラーコード<th>エラー名<th>トラブルシューティング</tr>
<tr><td rowspan="3">共通<td>900<td>システムビジー<td>リクエストを再送信します。エラーが継続するときはコントローラを再起動します。</tr>
<tr><td>901<td>リクエスト受付不可<td><b>接続</b>インジケータの点灯を確認します。<br>消灯していたらLANケーブルが外れていないか確認します。<br>ロボット通信を再起動します(<b>ロボット</b>ボタン切⇒入)</tr>
<tr><td>999<td>座標フォーマットエラー<td>エラーが続く場合は、システムを再起動します</tr>
<tr><td rowspan="2">CAPTURE<td>911<td>撮影タイムアウト<td>カメラケーブル接続を確認します</tr>
<tr><td>912<td>撮影エラー<td>カメラドライバーを再起動します(<b>SXGAカメラ</b>ボタン切⇒入)</tr>
<tr><td rowspan="4">SOLVE<td>921<td>認識タイムアウト<td>エラーが続く場合は、システムを再起動します</tr>
<tr><td>922<td>一致度エラー<td>物体形状に即した点群が撮れているか確認します。十分でない場合は<br>・撮影条件を調整する<br>・撮影位置を変えて再撮影(重ね撮り)する
</tr>
<tr><td>923<td>上下限エラー<td>レポートにて外れている項目を確認し、エラー原因を除きます</tr>
<tr><td>923<td>座標ルックアップエラー<td>エラーが続く場合は、システムを再起動します</tr>
<tr><td rowspan="2">RECIPE<td>931<td>レシピ設定タイムアウト<td>エラーが続く場合は、システムを再起動します</tr>
<tr><td>932<td>レシピ読込エラー<td>指定されたレシピが存在するかどうか確認します。</tr>
</table>
